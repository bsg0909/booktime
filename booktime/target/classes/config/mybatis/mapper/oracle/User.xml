<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="config.mybatis.mapper.oracle.user">
	<insert id="insertUser" parameterType="userVo">
		insert into "USER"(userid, pwd, name, birth, gender, grade, email1,email2, 
		emailagree, zipcode, parseladdress, newaddress,addressdetail,phone)
		values(#{userid},#{pwd},#{name},#{birth},#{gender},#{grade},
		#{email1},#{email2},#{emailagree},#{zipcode},#{parseladdress},#{newaddress},
		#{addressdetail},#{phone})
	</insert>

	<select id="chkUserid" parameterType="string" resultType="int">
		select count(*) from "USER" where userid=#{userid}
	</select>
	
	<select id="userGetPwd" parameterType="string" resultType="string">
		select pwd from "USER"
		where userid=#{userid} and withdrawaldate is null
	</select>
	
	<select id="selectByUserid" parameterType="string" resultType="userVo">
		select * from "USER" where userid=#{userid}
	</select>
	
	<update id="deleteUser" parameterType="string">
		update "USER"
		set withdrawaldate = sysdate , withdrawalreason=#{withdrawalreason}
		where userid=#{userid} and withdrawaldate is null
	</update>
	
	<select id="selectPWD" parameterType="string" resultType="string">
		select pwd from "USER" where userid=#{userid} and withdrawaldate is null
	</select>
	
	<update id="updateMileage" parameterType="mileageVo">
		update "USER"
		set mileage = mileage
		<if test="savingPoint>0">+#{savingPoint}</if>
		<if test="usePoint>0">-#{usePoint}</if>
		where userid=#{userid}
	</update>
	
	<select id="selectByEmail" parameterType="userVo" resultType="String">
		select userid from "USER" where email1=#{email1} and email2=#{email2}
	</select>
	
	<update id="resetPwd" parameterType="userVo">
		update "USER"
		set pwd = #{pwd}
		where userid=#{userid}
	</update>
	
	<select id="selectAllUser" resultType="userVo">
		select * from "USER" order by grade 
	</select>
	
</mapper>









